<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ³¨éŸ³ç­†é †ç·´ç¿’ Demoï¼ˆã„…ï¼‰</title>

  <style>
    @font-face {
      font-family: 'BpmfIansui';
      src: url('../BpmfIansui-Regular.ttf') format('truetype');
      font-display: swap;
    }

    body {
      margin: 0;
      font-family: 'BpmfIansui', 'Noto Sans TC', sans-serif;
      background: #111;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 16px;
      text-align: center;
    }

    h1 {
      font-size: 1.6rem;
      margin-bottom: 8px;
    }

    .hint {
      font-size: 0.9rem;
      color: #ccc;
      margin-bottom: 12px;
    }

    .board {
      position: relative;
      width: min(80vw, 280px);
      height: min(80vw, 280px);
      background: #222;
      border: 4px solid #444;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 16px;
      touch-action: manipulation;
      user-select: none;
    }

    .char {
      font-size: min(50vw, 200px);
      color: #eee;
      pointer-events: none;
    }

    /* ç²—ç•¥é¡¯ç¤ºç­†ç•«ä½ç½® */
    .stroke-visual {
      position: absolute;
      background: rgba(255, 255, 0, 0.5);
      border-radius: 4px;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
    }
    .stroke-visual.active {
      opacity: 1;
    }

    /* é€æ˜è§¸æ§å€ */
    .zone {
      position: absolute;
      background: transparent;
    }

    .zone1 { top:22%; left:18%; width:64%; height:20%; }
    .zone2 { top:26%; left:22%; width:20%; height:55%; }
    .zone3 { top:58%; left:54%; width:28%; height:24%; }

    .steps {
      max-width: 320px;
      width: 100%;
      background: #222;
      border-radius: 10px;
      border: 2px solid #444;
      padding: 10px 12px;
      font-size: 0.95rem;
      margin-bottom: 10px;
      text-align:left;
    }

    .steps-title { font-weight: bold; margin-bottom: 6px; }
    .steps li { margin: 4px 0; padding: 2px 4px; border-radius: 4px; }
    .steps li.current { background:#444; color:#ffeb3b; }
    .steps li.done { color:#a5d6a7; }

    .status { margin: 8px 0 12px; min-height:1.2em; }
    .status.ok { color:#a5d6a7; }
    .status.hint2 { color:#ffeb3b; }
    .status.error { color:#ff8a80; }

    .done-big { font-size:1.2rem; color:#a5d6a7; margin-top:4px; }

    .btn-row { display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }

    button {
      font-family:'BpmfIansui','Noto Sans TC',sans-serif;
      padding:6px 12px;
      border-radius:6px;
      border:2px solid #333;
      background:#4caf50;
      color:#fff;
      cursor:pointer;
      font-size:0.9rem;
    }
    button.secondary { background:#555; }
    button:active { transform: translateY(1px); }
  </style>
</head>

<body>

  <h1>æ³¨éŸ³ç­†é †ç·´ç¿’ Demoï¼šã„…</h1>
  <div class="hint">ç”¨æ‰‹æŒ‡ç…§è‘—ç­†é †å¯«ï¼šæ©« â†’ è± â†’ çŸ­æ©«</div>

  <!-- ğŸ”Š ç™¼éŸ³æŒ‰éˆ• -->
  <button id="speakBtn" style="margin-bottom:12px;">ğŸ”Š ç™¼éŸ³ï¼šã„…</button>

  <div class="board" id="board">
    <div class="char">ã„…</div>

    <!-- å¯è¦–åŒ–ç­†ç•«ä½ç½® -->
    <div class="stroke-visual" id="vis1"
         style="top:25%; left:20%; width:60%; height:10%;"></div>
    <div class="stroke-visual" id="vis2"
         style="top:28%; left:25%; width:10%; height:50%;"></div>
    <div class="stroke-visual" id="vis3"
         style="top:60%; left:58%; width:22%; height:14%;"></div>

    <!-- é€æ˜å€åŸŸ -->
    <div class="zone zone1" data-step="0"></div>
    <div class="zone zone2" data-step="1"></div>
    <div class="zone zone3" data-step="2"></div>
  </div>

  <div class="steps">
    <div class="steps-title">ã„… çš„ç­†é †ï¼š</div>
    <ol>
      <li id="step1">â‘  å…ˆå¯«ä¸Šé¢çš„ä¸€æ©«ï¼ˆå·¦ â†’ å³ï¼‰</li>
      <li id="step2">â‘¡ å†å¯«å·¦é‚Šçš„ä¸€è±ï¼ˆä¸Š â†’ ä¸‹ï¼‰</li>
      <li id="step3">â‘¢ æœ€å¾Œå¯«å³ä¸‹è§’çš„çŸ­æ©«</li>
    </ol>
  </div>

  <div class="status" id="status"></div>
  <div class="done-big" id="doneBig"></div>

  <div class="btn-row">
    <button id="resetBtn" class="secondary">é‡æ–°å¯«ä¸€æ¬¡</button>
  </div>

<script>
  // -----------------------------
  // ç™¼éŸ³åŠŸèƒ½ï¼ˆSpeechSynthesisï¼‰
  // -----------------------------
  function speak(text) {
    const uttr = new SpeechSynthesisUtterance(text);
    uttr.lang = "zh-TW"; // å°ç£ä¸­æ–‡
    uttr.rate = 0.9;     // èªé€Ÿç¨æ…¢æ›´é©åˆå°å­©
    speechSynthesis.speak(uttr);
  }

  document.getElementById("speakBtn").onclick = () => {
    speak("ã„…");
  };

  // -----------------------------
  // ç­†ç•«é‚è¼¯
  // -----------------------------
  let currentStep = 0;
  const totalSteps = 3;

  const statusEl = document.getElementById('status');
  const doneBigEl = document.getElementById('doneBig');

  const stepEls = [
    document.getElementById('step1'),
    document.getElementById('step2'),
    document.getElementById('step3')
  ];

  const vis = [
    document.getElementById('vis1'),
    document.getElementById('vis2'),
    document.getElementById('vis3')
  ];

  function updateUI() {
    // æ›´æ–°æ­¥é©Ÿæ–‡å­—é¡¯ç¤º
    stepEls.forEach((li, idx) => {
      li.className = "";
      if (idx < currentStep) li.classList.add("done");
      else if (idx === currentStep) li.classList.add("current");
    });

    // æ›´æ–°ç­†ç•«å¯è¦–åŒ–
    vis.forEach(v => v.classList.remove("active"));
    if (currentStep < totalSteps) vis[currentStep].classList.add("active");

    // ç‹€æ…‹æç¤º
    const msgs = [
      "å…ˆå¯«ä¸Šé¢çš„ä¸€æ©«ï¼ˆå·¦åˆ°å³ï¼‰ã€‚",
      "åšå¾—å¾ˆå¥½ï¼æ¥è‘—å¯«å·¦é‚Šçš„ä¸€è±ï¼ˆä¸Šåˆ°ä¸‹ï¼‰ã€‚",
      "æœ€å¾Œåœ¨å³ä¸‹è§’ç•«ä¸€å€‹çŸ­æ©«ã€‚",
      "å®Œæˆï¼ä»Šå¤©çš„ ã„… å¯«å¾—å¾ˆå¥½ï¼"
    ];
    statusEl.textContent = msgs[currentStep] || "";
    doneBigEl.textContent = currentStep >= totalSteps ? "ğŸ‰ å®Œæˆï¼" : "";
  }

  function handleZoneTap(stepIndex) {
    if (currentStep >= totalSteps) return; // å·²å®Œæˆ

    if (stepIndex === currentStep) {
      currentStep++;
      updateUI();
    } else {
      statusEl.textContent = "å…ˆç…§ç­†é †ä¾†å–”ï½çœ‹æç¤ºï¼";
      statusEl.className = "status error";
    }
  }

  // ç¶å®šè§¸æ§ / é»æ“Š
  document.querySelectorAll('.zone').forEach(zone => {
    const stepIndex = parseInt(zone.dataset.step, 10);
    const onTap = e => {
      e.preventDefault();
      handleZoneTap(stepIndex);
    };
    zone.addEventListener('click', onTap);
    zone.addEventListener('touchstart', onTap, { passive: false });
  });

  // é‡ç½®
  document.getElementById('resetBtn').onclick = () => {
    currentStep = 0;
    updateUI();
  };

  // åˆå§‹åŒ–
  updateUI();
</script>

</body>
</html>
